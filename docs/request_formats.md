# Форматы запросов

## Запрос на сертификат
- Должен быть подписанным сообщением в формате PKCS#7.
- Подписанные данные содержат бинарное представление PKCS#10 запроса на сертификат.
- Содержимое выпускаемого сертификата определяется шаблоном сертификата.

### Варианты указания шаблона:
1. Внутри PKCS#10 запроса (OID, версии, или короткое имя в расширении CertType)
2. Внутри подписанного атрибута NameValuePair (OID или имя шаблона)

### Дополнительные параметры:
- CpRaCertPeriod / CpRaCertPeriodUnits — срок действия сертификата
- CpRaKeyPeriod / CpRaKeyPeriodUnits — срок действия ключа ЭП
- CpRaStartDate — дата начала
- CpRaExpirationDate — дата окончания
- CpRaKeyExpirationDate — дата окончания ключа ЭП

## Запрос на отзыв
- Должен быть подписанным сообщением в формате PKCS#7.
- Подписанные данные содержат строковое представление (UTF16 LE без BOM) запроса на отзыв.

### Форматы строки запроса:
- SN=SerialNumber,IN=IssuerName,RR=RevocationReason
- SN=SerialNumber,TP=Thumbprint,RR=RevocationReason

#### Пояснения:
- SerialNumber — серийный номер сертификата
- IssuerName — имя издателя (ASN.1 DER, base64)
- Thumbprint — отпечаток сертификата
- RevocationReason — код причины отзыва (0-5)

## Подпись запросов
- Запрос может быть подписан на ключе сертификата заявителя или оператора.
- Возможна отправка с одновременным одобрением (двойная подпись или атрибут commitment-type-indication).
- Одобренный запрос подписывается отдельно. 